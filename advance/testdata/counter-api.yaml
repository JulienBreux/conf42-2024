---
openapi: 3.1.0
info:
  title: Counter API
  version: 1.0.0
paths:
  /:
    get:
      summary: Increment and get a counter
      operationId: GetCounter
      x-microcks-operation:
        dispatcher: SCRIPT
        dispatcherRules: |-
          def invJson = new URL("http://127.0.0.1:8080/api/metrics/invocations/Counter%20API/1.0.0").getText();
          def inv = new groovy.json.JsonSlurper().parseText(invJson).dailyCount
          log.info("daily invocation: " + inv)
          requestContext.counter = inv;
      responses:
        '200':
          description: Success counter
          content:
            plain/text:
              schema:
                type: string
              examples:
                counter:
                  value: "{{ counter }}"
